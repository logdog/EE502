function dy = simpend(y,m1,m2,L1,L2,g,u)

x1 = y(1);
x2 = y(2);
x3 = y(3);
x4 = y(4);
x5 = y(5);
x6 = y(6);

% equations of motion for a double-pendulum on cart
dy(1,1) = y(2);
dy(2,1) = -(m1*u + m2*u - m2*u*cos(x3 - x5)^2 + L1*m1^2*x4^2*sin(x3) + L1*m2^2*x4^2*sin(x3) + L2*m2^2*x6^2*sin(x5) - g*m1^2*cos(x3)*sin(x3) - g*m2^2*cos(x3)*sin(x3) - g*m2^2*cos(x5)*sin(x5) + 2*L1*m1*m2*x4^2*sin(x3) + L2*m1*m2*x6^2*sin(x5) - L1*m2^2*x4^2*sin(x3 - x5)*cos(x5) + L2*m2^2*x6^2*sin(x3 - x5)*cos(x3) - 2*g*m1*m2*cos(x3)*sin(x3) - g*m1*m2*cos(x5)*sin(x5) + g*m2^2*cos(x3 - x5)*cos(x3)*sin(x5) + g*m2^2*cos(x3 - x5)*cos(x5)*sin(x3) - L1*m2^2*x4^2*cos(x3 - x5)^2*sin(x3) - L2*m2^2*x6^2*cos(x3 - x5)^2*sin(x5) - L1*m1*m2*x4^2*sin(x3 - x5)*cos(x5) + L2*m1*m2*x6^2*sin(x3 - x5)*cos(x3) + L1*m2^2*x4^2*cos(x3 - x5)*sin(x3 - x5)*cos(x3) - L2*m2^2*x6^2*cos(x3 - x5)*sin(x3 - x5)*cos(x5) + g*m1*m2*cos(x3 - x5)*cos(x3)*sin(x5) + g*m1*m2*cos(x3 - x5)*cos(x5)*sin(x3) - L1*m1*m2*x4^2*cos(x3 - x5)^2*sin(x3) + L1*m1*m2*x4^2*cos(x3 - x5)*sin(x3 - x5)*cos(x3))/(m1^2*cos(x3)^2 - M*m2 - 2*m1*m2 - M*m1 + m2^2*cos(x3)^2 + m2^2*cos(x5)^2 + m2^2*cos(x3 - x5)^2 - m1^2 - m2^2 + 2*m1*m2*cos(x3)^2 + m1*m2*cos(x5)^2 + M*m2*cos(x3 - x5)^2 + m1*m2*cos(x3 - x5)^2 - 2*m2^2*cos(x3 - x5)*cos(x3)*cos(x5) - 2*m1*m2*cos(x3 - x5)*cos(x3)*cos(x5));
dy(3,1) = y(4);
dy(4,1) = (m1*u*cos(x3) + m2*u*cos(x3) - g*m1^2*sin(x3) - g*m2^2*sin(x3) - m2*u*cos(x3 - x5)*cos(x5) - M*g*m1*sin(x3) - M*g*m2*sin(x3) + L2*m2^2*x6^2*sin(x3 - x5) - 2*g*m1*m2*sin(x3) + g*m2^2*cos(x3 - x5)*sin(x5) + g*m2^2*cos(x5)^2*sin(x3) + L1*m1^2*x4^2*cos(x3)*sin(x3) + L1*m2^2*x4^2*cos(x3)*sin(x3) + L2*m2^2*x6^2*cos(x3)*sin(x5) - g*m2^2*cos(x3)*cos(x5)*sin(x5) + L2*M*m2*x6^2*sin(x3 - x5) + M*g*m2*cos(x3 - x5)*sin(x5) + L2*m1*m2*x6^2*sin(x3 - x5) + L1*m2^2*x4^2*cos(x3 - x5)*sin(x3 - x5) + g*m1*m2*cos(x3 - x5)*sin(x5) - L2*m2^2*x6^2*sin(x3 - x5)*cos(x5)^2 + g*m1*m2*cos(x5)^2*sin(x3) + 2*L1*m1*m2*x4^2*cos(x3)*sin(x3) + L2*m1*m2*x6^2*cos(x3)*sin(x5) - L1*m2^2*x4^2*cos(x3 - x5)*cos(x5)*sin(x3) - L1*m2^2*x4^2*sin(x3 - x5)*cos(x3)*cos(x5) - L2*m2^2*x6^2*cos(x3 - x5)*cos(x5)*sin(x5) - g*m1*m2*cos(x3)*cos(x5)*sin(x5) + L1*M*m2*x4^2*cos(x3 - x5)*sin(x3 - x5) + L1*m1*m2*x4^2*cos(x3 - x5)*sin(x3 - x5) - L1*m1*m2*x4^2*cos(x3 - x5)*cos(x5)*sin(x3) - L1*m1*m2*x4^2*sin(x3 - x5)*cos(x3)*cos(x5))/(L1*(m1^2*cos(x3)^2 - M*m2 - 2*m1*m2 - M*m1 + m2^2*cos(x3)^2 + m2^2*cos(x5)^2 + m2^2*cos(x3 - x5)^2 - m1^2 - m2^2 + 2*m1*m2*cos(x3)^2 + m1*m2*cos(x5)^2 + M*m2*cos(x3 - x5)^2 + m1*m2*cos(x3 - x5)^2 - 2*m2^2*cos(x3 - x5)*cos(x3)*cos(x5) - 2*m1*m2*cos(x3 - x5)*cos(x3)*cos(x5)));
dy(5,1) = y(6);
dy(6,1) = -(g*m1^2*sin(x5) - m2*u*cos(x5) - m1*u*cos(x5) + g*m2^2*sin(x5) + m1*u*cos(x3 - x5)*cos(x3) + m2*u*cos(x3 - x5)*cos(x3) + M*g*m1*sin(x5) + M*g*m2*sin(x5) + L1*m1^2*x4^2*sin(x3 - x5) + L1*m2^2*x4^2*sin(x3 - x5) + 2*g*m1*m2*sin(x5) - g*m1^2*cos(x3 - x5)*sin(x3) - g*m2^2*cos(x3 - x5)*sin(x3) - g*m1^2*cos(x3)^2*sin(x5) - g*m2^2*cos(x3)^2*sin(x5) - L1*m1^2*x4^2*cos(x5)*sin(x3) - L1*m2^2*x4^2*cos(x5)*sin(x3) - L2*m2^2*x6^2*cos(x5)*sin(x5) + g*m1^2*cos(x3)*cos(x5)*sin(x3) + g*m2^2*cos(x3)*cos(x5)*sin(x3) + L1*M*m1*x4^2*sin(x3 - x5) + L1*M*m2*x4^2*sin(x3 - x5) - M*g*m1*cos(x3 - x5)*sin(x3) - M*g*m2*cos(x3 - x5)*sin(x3) + 2*L1*m1*m2*x4^2*sin(x3 - x5) + L2*m2^2*x6^2*cos(x3 - x5)*sin(x3 - x5) - 2*g*m1*m2*cos(x3 - x5)*sin(x3) - L1*m1^2*x4^2*sin(x3 - x5)*cos(x3)^2 - L1*m2^2*x4^2*sin(x3 - x5)*cos(x3)^2 - 2*g*m1*m2*cos(x3)^2*sin(x5) - 2*L1*m1*m2*x4^2*cos(x5)*sin(x3) - L2*m1*m2*x6^2*cos(x5)*sin(x5) + L1*m1^2*x4^2*cos(x3 - x5)*cos(x3)*sin(x3) + L1*m2^2*x4^2*cos(x3 - x5)*cos(x3)*sin(x3) + L2*m2^2*x6^2*cos(x3 - x5)*cos(x3)*sin(x5) - L2*m2^2*x6^2*sin(x3 - x5)*cos(x3)*cos(x5) + 2*g*m1*m2*cos(x3)*cos(x5)*sin(x3) + L2*M*m2*x6^2*cos(x3 - x5)*sin(x3 - x5) + L2*m1*m2*x6^2*cos(x3 - x5)*sin(x3 - x5) - 2*L1*m1*m2*x4^2*sin(x3 - x5)*cos(x3)^2 + 2*L1*m1*m2*x4^2*cos(x3 - x5)*cos(x3)*sin(x3) + L2*m1*m2*x6^2*cos(x3 - x5)*cos(x3)*sin(x5) - L2*m1*m2*x6^2*sin(x3 - x5)*cos(x3)*cos(x5))/(L2*(m1^2*cos(x3)^2 - M*m2 - 2*m1*m2 - M*m1 + m2^2*cos(x3)^2 + m2^2*cos(x5)^2 + m2^2*cos(x3 - x5)^2 - m1^2 - m2^2 + 2*m1*m2*cos(x3)^2 + m1*m2*cos(x5)^2 + M*m2*cos(x3 - x5)^2 + m1*m2*cos(x3 - x5)^2 - 2*m2^2*cos(x3 - x5)*cos(x3)*cos(x5) - 2*m1*m2*cos(x3 - x5)*cos(x3)*cos(x5)));
end

